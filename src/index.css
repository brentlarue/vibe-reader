@tailwind base;
@tailwind components;
@tailwind utilities;

/* Prevent horizontal scroll */
html, body {
  overflow-x: hidden;
  max-width: 100vw;
}

body {
  position: relative;
  width: 100%;
  /* iOS safe area support */
  padding-top: env(safe-area-inset-top);
  padding-left: env(safe-area-inset-left);
  padding-right: env(safe-area-inset-right);
}

/* iOS standalone mode (Add to Home Screen) */
@media all and (display-mode: standalone) {
  body {
    /* Ensure background extends under status bar */
    background-color: var(--theme-bg);
  }
  
  /* Account for iOS status bar height in standalone mode */
  #root {
    min-height: 100dvh;
    min-height: -webkit-fill-available;
  }
}

/* Touch optimization */
* {
  -webkit-tap-highlight-color: transparent;
}

.touch-manipulation {
  touch-action: manipulation;
}

/* Ensure all containers respect viewport width */
#root {
  width: 100%;
  max-width: 100vw;
  overflow-x: hidden;
}

@layer base {
  :root {
    /* Light theme (default) */
    --theme-bg: #ffffff;
    --theme-text: #111827;
    --theme-text-secondary: #4b5563;
    --theme-text-muted: #6b7280;
    --theme-placeholder: #9ca3af;
    --theme-border: #e5e7eb;
    --theme-accent: #000000;
    --theme-hover-bg: #f9fafb;
    --theme-card-bg: #ffffff;
    --theme-button-bg: #000000;
    --theme-button-text: #ffffff;
  }

  body {
    @apply antialiased;
    background-color: var(--theme-bg);
    color: var(--theme-text);
    font-family: -apple-system, BlinkMacSystemFont, 'Helvetica Neue', Arial, sans-serif;
  }

  /* Dark theme */
  .theme-dark {
    --theme-bg: #1a1a1a;
    --theme-text: #ffffff;
    --theme-text-secondary: #ffffff;
    --theme-text-muted: #a3a3a3;
    --theme-placeholder: #737373;
    --theme-border: #404040;
    --theme-accent: #ffffff;
    --theme-hover-bg: #262626;
    --theme-card-bg: #1a1a1a;
    --theme-button-bg: #ffffff;
    --theme-button-text: #000000;
  }

  /* Sepia theme */
  .theme-sepia {
    --theme-bg: #f4ecd8;
    --theme-text: #5c4033;
    --theme-text-secondary: #6b4e3d;
    --theme-text-muted: #8b6f47;
    --theme-placeholder: #a08b6f;
    --theme-border: #d4c4a8;
    --theme-accent: #5c4033;
    --theme-hover-bg: #ede4d0;
    --theme-card-bg: #f4ecd8;
    --theme-button-bg: #5c4033;
    --theme-button-text: #ffffff;
  }

  /* Hacker News theme */
  .theme-hn {
    --theme-bg: #f6f6ef;
    --theme-text: #000000;
    --theme-text-secondary: #333333;
    --theme-text-muted: #828282;
    --theme-placeholder: #999999;
    --theme-border: #e0e0e0;
    --theme-accent: #ff6600;
    --theme-hover-bg: #eeeeea;
    --theme-card-bg: #f6f6ef;
    --theme-button-bg: #ff6600;
    --theme-button-text: #ffffff;
  }

  /* Sepia mode - serif font for body text */
  .theme-sepia .article-content,
  .theme-sepia article {
    font-family: 'PT Serif', Georgia, 'Times New Roman', serif;
    font-weight: 400;
  }
  
  .theme-sepia .article-content h2,
  .theme-sepia .article-content h3,
  .theme-sepia article h2,
  .theme-sepia article h3 {
    font-weight: 700;
  }
}

@layer components {
  .article-content {
    @apply text-base sm:text-lg;
    color: var(--theme-text-secondary);
    line-height: 1.75;
  }

  .article-content p {
    @apply mb-7;
    line-height: 1.75;
  }

  .article-content h2 {
    @apply text-2xl font-semibold mt-12 mb-6 leading-tight tracking-tight;
    color: var(--theme-text);
  }

  .article-content h3 {
    @apply text-xl font-semibold mt-8 mb-4 leading-tight tracking-tight;
    color: var(--theme-text);
  }

  .article-content ul,
  .article-content ol {
    @apply mb-7 pl-6;
    line-height: 1.75;
  }

  .article-content li {
    @apply mb-3;
    line-height: 1.75;
  }

  .article-content a {
    color: var(--theme-text);
    @apply underline hover:no-underline;
  }

  .line-clamp-ellipsis {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 3;
    line-clamp: 3;
    text-overflow: ellipsis;
    line-height: 1.625rem;
  }
}
